package binarysearch_test

import (
	"testing"

	binarysearch "github.com/amir-mln/algorithm/educative/binary-search"
)

func TestSearchInRotatedSortedArray(t *testing.T) {
	cases := []struct {
		name    string
		numbers []int
		target  int
		output  int
	}{
		{
			name:    "test case 1",
			numbers: []int{6, 7, 1, 2, 3, 4, 5},
			target:  3,
			output:  4,
		},
		{
			name:    "test case 2",
			numbers: []int{6, 7, 1, 2, 3, 4, 5},
			target:  6,
			output:  0,
		},
		{
			name:    "test case 3",
			numbers: []int{4, 5, 6, 1, 2, 3},
			target:  3,
			output:  5,
		},
		{
			name:    "test case 4",
			numbers: []int{4, 5, 6, 1, 2, 3},
			target:  6,
			output:  2,
		},
		{
			name:    "test case 5",
			numbers: []int{4},
			target:  1,
			output:  -1,
		},
		{
			name:    "test case 6",
			numbers: []int{-10000},
			target:  -10000,
			output:  0,
		},
		{
			name:    "test case 7",
			numbers: []int{-1267, -1259, -1243, -1237, -1229, -1217, -1198, -1189, -1166, -1160, -1157, -1137, -1097, -1092, -1080, -1075, -1071, -1045, -1010, -1000, -971, -966, -962, -933, -925, -922, -842, -838, -811, -756, -752, -751, -742, -741, -727, -726, -715, -683, -644, -616, -583, -561, -537, -517, -473, -466, -458, -456, -446, -444, -391, -379, -357, -355, -332, -294, -284, -280, -275, -274, -243, -220, -214, -199, -192, -158, -146, -142, -134, -117, -78, -50, -49, -35, -30, -18, -15, -4, 6, 31, 49, 103, 165, 174, 177, 231, 233, 256, 260, 278, 284, 295, 312, 327, 351, 382, 385, 430, 453, 457, 461, 476, 547, 557, 576, 591, 607, 617, 625, 645, 653, 685, 709, 714, 741, 756, 797, 818, 853, 855, 858, 889, 908, 919, 946, 998, 1013, 1030, 1052, 1053, 1066, 1068, 1075, 1093, 1138, 1149, 1150, 1166, 1192, 1204, 1253, 1277, 1301, 1325, 1341, 1361, 1381, 1411, 1429, 1457, 1463, 1497, 1540, 1548, 1623, 1681, 1686, 1762, 1766, 1788, 1798, 1821, 1835, 1840, 1862, 1865, 1875, 1890, 1896, 1905, 1918, 1971, 1992, 2034, 2071, 2079, 2094, 2099, 2150, 2157, 2158, 2176, 2181, 2186, 2193, 2207, 2217, 2226, 2229, 2263, 2301, 2326, 2360, 2394, 2399, 2407, 2412, 2448, 2473, 2483, 2488, 2520, 2521, 2576, 2626, 2646, 2656, 2659, 2671, 2681, 2734, 2743, 2762, 2765, 2782, 2787, 2797, 2845, 2875, 2885, 2900, 2920, 2950, 2968, 2975, 2978, 2979, 2982, 3005, 3044, 3066, 3084, 3091, 3106, 3117, 3123, 3148, 3161, 3162, 3165, 3242, 3261, 3308, 3318, 3319, 3327, 3366, 3408, 3415, 3419, 3433, 3442, 3502, 3524, 3534, 3621, 3630, 3636, 3653, 3701, 3718, 3723, 3731, 3739, 3753, 3813, 3848, 3863, 3871, 3873, 3889, 3937, 3941, 3950, 3968, 3983, 3989, 4023, 4060, 4073, 4082, 4086, 4093, 4112, 4113, 4126, 4215, 4250, 4269, 4285, 4333, 4336, 4345, 4388, 4391, 4414, 4432, 4465, 4469, 4486, 4496, 4503, 4519, 4534, 4537, 4607, 4684, 4686, 4691, 4693, 4697, 4719, 4721, 4778, 4797, 4822, 4856, 4862, 4867, 4873, 4877, 4915, 4916, 4921, 4939, 4941, 4949, 4965, 5033, 5061, 5104, 5112, 5137, 5152, 5156, 5184, 5187, 5201, 5235, 5238, 5243, 5265, 5308, 5322, 5334, 5355, 5363, 5376, 5390, 5453, 5455, 5475, 5488, 5502, 5510, 5547, 5628, 5630, 5647, 5658, 5758, 5770, 5779, 5782, 5785, 5797, 5821, 5833, 5904, 5908, 5909, 5916, 5925, 5932, 5952, 6007, 6044, 6045, 6046, 6058, 6060, 6074, 6098, 6101, 6136, 6153, 6193, 6202, 6224, 6238, 6260, 6267, 6275, 6288, 6296, 6304, 6385, 6387, 6402, 6410, 6429, 6434, 6445, 6474, 6478, 6484, 6495, 6498, 6548, 6595, 6658, 6661, 6670, 6674, 6677, 6713, 6743, 6753, 6780, 6801, 6814, 6818, 6853, 6871, 6872, 6897, 6898, 6921, 6928, 6966, 6974, 6983, 7003, 7005, 7061, 7096, 7102, 7123, 7157, 7169, 7170, 7196, 7220, 7278, 7281, 7283, 7286, 7355, 7405, 7408, 7409, 7425, 7445, 7459, 7496, 7509, 7520, 7529, 7543, 7555, 7622, 7679, 7681, 7689, 7696, 7732, 7752, 7753, 7759, 7769, 7771, 7791, 7841, 7862, 7882, 7888, 7895, 7902, 7921, 7931, 7943, 7978, 7991, 8054, 8070, 8092, 8099, 8134, 8136, 8204, 8207, 8213, 8225, 8231, 8255, 8262, 8288, 8297, 8331, 8338, 8350, 8447, 8465, 8471, 8473, 8544, 8571, 8574, 8592, 8715, 8750, 8767, 8834, 8835, 8889, 8909, 8940, 8947, 8969, 8994, 9005, 9068, 9086, 9088, 9094, 9119, 9132, 9236, 9243, 9282, 9284, 9285, 9353, 9422, 9483, 9500, 9504, 9521, 9523, 9584, 9623, 9626, 9639, 9661, 9685, 9692, 9822, 9828, 9868, 9900, 9910, 9915, 9928, 9931, 9941, 9947, 9978, 9979, 9980, 9988, 9995, -10000, -9994, -9946, -9936, -9922, -9921, -9908, -9835, -9805, -9751, -9710, -9663, -9657, -9622, -9599, -9585, -9571, -9534, -9524, -9512, -9505, -9463, -9447, -9401, -9395, -9378, -9356, -9328, -9287, -9250, -9249, -9206, -9187, -9181, -9144, -9137, -9127, -9123, -9098, -9091, -9056, -9054, -8985, -8966, -8955, -8951, -8942, -8924, -8882, -8871, -8870, -8868, -8867, -8851, -8848, -8825, -8824, -8817, -8815, -8754, -8751, -8749, -8734, -8724, -8714, -8666, -8646, -8631, -8619, -8600, -8589, -8586, -8584, -8577, -8570, -8567, -8556, -8554, -8545, -8542, -8506, -8472, -8458, -8438, -8436, -8431, -8392, -8385, -8371, -8365, -8363, -8354, -8321, -8287, -8263, -8260, -8214, -8210, -8199, -8192, -8174, -8160, -8159, -8128, -8120, -8058, -8051, -8049, -8042, -8038, -8030, -8006, -8005, -8002, -7993, -7964, -7962, -7958, -7946, -7942, -7936, -7919, -7887, -7882, -7842, -7823, -7821, -7792, -7786, -7770, -7765, -7755, -7754, -7731, -7722, -7713, -7711, -7708, -7651, -7643, -7588, -7550, -7543, -7533, -7530, -7514, -7489, -7460, -7434, -7416, -7385, -7371, -7369, -7335, -7333, -7288, -7283, -7267, -7247, -7240, -7233, -7212, -7184, -7182, -7160, -7139, -7127, -7096, -7084, -7080, -7048, -7030, -7019, -6994, -6972, -6968, -6943, -6941, -6929, -6890, -6867, -6854, -6836, -6819, -6816, -6799, -6724, -6713, -6643, -6635, -6597, -6591, -6577, -6552, -6548, -6526, -6518, -6514, -6499, -6495, -6487, -6441, -6407, -6373, -6360, -6343, -6317, -6300, -6297, -6294, -6269, -6236, -6218, -6156, -6137, -6095, -6093, -6052, -6000, -5939, -5898, -5895, -5830, -5827, -5826, -5800, -5765, -5764, -5733, -5726, -5718, -5670, -5652, -5632, -5620, -5616, -5507, -5496, -5494, -5487, -5434, -5400, -5399, -5367, -5352, -5346, -5338, -5328, -5307, -5251, -5241, -5226, -5184, -5168, -5152, -5131, -5112, -5109, -5095, -5059, -5028, -5009, -4992, -4975, -4959, -4943, -4888, -4832, -4818, -4786, -4781, -4771, -4748, -4726, -4718, -4668, -4647, -4636, -4594, -4577, -4562, -4524, -4515, -4491, -4483, -4470, -4468, -4452, -4432, -4413, -4331, -4330, -4312, -4242, -4236, -4232, -4227, -4206, -4170, -4163, -4117, -4092, -4080, -4072, -4070, -4036, -3989, -3988, -3954, -3950, -3924, -3858, -3840, -3832, -3831, -3762, -3732, -3685, -3657, -3636, -3634, -3627, -3561, -3539, -3497, -3476, -3453, -3449, -3387, -3342, -3312, -3311, -3307, -3296, -3291, -3256, -3199, -3153, -3136, -3133, -3103, -3082, -3067, -3057, -3039, -3024, -2989, -2983, -2977, -2973, -2959, -2917, -2909, -2904, -2883, -2869, -2840, -2834, -2801, -2796, -2778, -2764, -2732, -2703, -2689, -2656, -2615, -2549, -2544, -2526, -2517, -2516, -2513, -2475, -2448, -2423, -2361, -2326, -2322, -2314, -2296, -2282, -2256, -2245, -2240, -2228, -2195, -2171, -2128, -2098, -2060, -2045, -1997, -1894, -1857, -1792, -1749, -1739, -1713, -1701, -1666, -1658, -1646, -1639, -1616, -1579, -1564, -1552, -1550, -1488, -1475, -1466, -1437, -1426, -1405, -1367, -1343, -1337, -1305, -1297, -1287, -1271},
			target:  -10000,
			output:  561,
		},
		{
			name:    "test case 8",
			numbers: []int{4104, 4122, 4146, 4147, 4155, 4170, 4177, 4179, 4196, 4205, 4254, 4263, 4293, 4295, 4322, 4342, 4349, 4358, 4382, 4385, 4387, 4452, 4537, 4557, 4560, 4618, 4623, 4624, 4626, 4639, 4661, 4681, 4700, 4758, 4763, 4779, 4805, 4848, 4852, 4878, 4885, 4896, 4898, 4906, 4907, 4998, 5011, 5021, 5074, 5144, 5165, 5182, 5195, 5206, 5264, 5283, 5302, 5338, 5339, 5399, 5404, 5432, 5536, 5595, 5613, 5749, 5762, 5773, 5787, 5796, 5797, 5840, 5849, 5892, 5906, 5947, 5966, 6050, 6052, 6069, 6104, 6111, 6120, 6134, 6144, 6173, 6174, 6216, 6256, 6263, 6277, 6307, 6325, 6361, 6389, 6437, 6483, 6506, 6563, 6615, 6621, 6648, 6675, 6698, 6700, 6705, 6711, 6758, 6771, 6787, 6823, 6875, 6904, 6920, 6926, 6931, 6949, 6964, 6976, 6978, 6998, 7004, 7074, 7076, 7077, 7079, 7186, 7196, 7207, 7210, 7252, 7266, 7270, 7288, 7298, 7308, 7330, 7347, 7376, 7386, 7388, 7395, 7423, 7446, 7456, 7479, 7491, 7496, 7501, 7523, 7582, 7615, 7624, 7632, 7634, 7697, 7705, 7768, 7797, 7811, 7813, 7842, 7852, 7886, 7887, 7891, 7899, 7922, 7927, 7935, 7944, 7967, 7982, 8026, 8098, 8119, 8127, 8143, 8153, 8180, 8186, 8203, 8277, 8311, 8328, 8360, 8368, 8370, 8382, 8461, 8472, 8516, 8534, 8538, 8540, 8559, 8583, 8669, 8686, 8691, 8746, 8760, 8766, 8782, 8794, 8818, 8831, 8856, 8880, 8911, 8950, 8961, 8975, 8983, 8993, 8995, 9016, 9032, 9046, 9065, 9072, 9125, 9132, 9184, 9186, 9226, 9255, 9288, 9305, 9319, 9357, 9399, 9426, 9441, 9454, 9470, 9490, 9515, 9518, 9521, 9570, 9584, 9591, 9614, 9629, 9659, 9673, 9680, 9702, 9845, 9848, 9873, 9889, 9918, 9920, 9956, -9995, -9972, -9959, -9951, -9949, -9934, -9875, -9869, -9828, -9825, -9796, -9784, -9781, -9753, -9746, -9745, -9734, -9709, -9649, -9625, -9624, -9611, -9595, -9592, -9591, -9538, -9502, -9480, -9475, -9440, -9438, -9399, -9355, -9330, -9313, -9302, -9278, -9254, -9170, -9136, -9130, -9123, -9106, -9103, -9097, -9093, -9068, -9055, -9050, -9011, -8981, -8960, -8944, -8938, -8921, -8898, -8871, -8839, -8829, -8789, -8785, -8781, -8743, -8730, -8725, -8721, -8703, -8682, -8681, -8625, -8624, -8597, -8583, -8553, -8536, -8533, -8525, -8507, -8502, -8498, -8471, -8445, -8405, -8398, -8368, -8353, -8349, -8342, -8331, -8330, -8318, -8310, -8306, -8294, -8291, -8268, -8251, -8244, -8205, -8191, -8164, -8098, -8063, -8046, -8016, -8005, -7988, -7984, -7983, -7938, -7932, -7919, -7901, -7892, -7886, -7854, -7851, -7840, -7778, -7710, -7699, -7695, -7636, -7603, -7592, -7578, -7533, -7498, -7475, -7389, -7379, -7368, -7311, -7310, -7298, -7266, -7263, -7242, -7232, -7218, -7216, -7211, -7164, -7141, -7119, -7117, -7106, -7103, -7087, -7041, -7034, -7027, -7026, -7013, -7002, -6985, -6964, -6960, -6955, -6954, -6928, -6908, -6882, -6879, -6866, -6859, -6795, -6780, -6776, -6761, -6713, -6609, -6601, -6596, -6547, -6510, -6493, -6468, -6450, -6416, -6412, -6397, -6394, -6356, -6338, -6331, -6300, -6285, -6270, -6233, -6194, -6148, -6136, -6119, -6117, -6113, -6059, -6042, -6010, -5993, -5952, -5936, -5924, -5888, -5851, -5776, -5774, -5766, -5757, -5756, -5755, -5747, -5740, -5725, -5711, -5705, -5694, -5639, -5628, -5620, -5576, -5573, -5572, -5532, -5495, -5488, -5473, -5469, -5453, -5444, -5435, -5400, -5364, -5347, -5288, -5253, -5251, -5242, -5214, -5195, -5178, -5168, -5164, -5156, -5148, -5119, -5093, -5082, -5075, -5064, -5045, -5043, -5042, -5023, -4994, -4991, -4974, -4973, -4972, -4955, -4926, -4909, -4908, -4897, -4863, -4858, -4844, -4840, -4829, -4787, -4782, -4723, -4706, -4690, -4680, -4677, -4676, -4666, -4618, -4608, -4604, -4584, -4550, -4531, -4488, -4465, -4454, -4444, -4436, -4426, -4419, -4418, -4338, -4265, -4264, -4249, -4236, -4224, -4196, -4194, -4190, -4158, -4138, -4133, -4132, -4129, -4088, -4028, -3958, -3957, -3948, -3893, -3876, -3832, -3811, -3782, -3781, -3761, -3757, -3727, -3719, -3713, -3701, -3612, -3581, -3560, -3531, -3507, -3478, -3460, -3429, -3418, -3415, -3396, -3354, -3345, -3327, -3317, -3315, -3308, -3267, -3260, -3231, -3223, -3217, -3211, -3139, -3129, -3126, -3118, -3089, -3084, -3075, -3043, -3041, -3019, -3003, -3002, -2988, -2952, -2927, -2904, -2871, -2868, -2853, -2829, -2821, -2819, -2802, -2788, -2756, -2755, -2733, -2723, -2693, -2681, -2680, -2659, -2606, -2563, -2543, -2512, -2476, -2456, -2392, -2349, -2327, -2319, -2315, -2301, -2296, -2278, -2274, -2269, -2260, -2259, -2245, -2226, -2225, -2185, -2175, -2174, -2141, -2131, -2122, -2071, -2069, -2066, -2057, -2036, -2006, -1978, -1922, -1918, -1917, -1916, -1905, -1904, -1896, -1894, -1879, -1871, -1830, -1807, -1786, -1748, -1706, -1704, -1693, -1691, -1654, -1638, -1626, -1615, -1608, -1597, -1591, -1540, -1531, -1526, -1494, -1487, -1484, -1473, -1469, -1464, -1458, -1451, -1448, -1441, -1420, -1419, -1412, -1370, -1348, -1321, -1305, -1276, -1274, -1266, -1263, -1257, -1253, -1252, -1249, -1240, -1238, -1212, -1211, -1199, -1185, -1172, -1159, -1144, -1116, -1107, -1106, -1046, -1021, -1004, -986, -981, -977, -973, -938, -929, -906, -884, -883, -848, -846, -800, -790, -774, -756, -720, -657, -615, -587, -558, -529, -519, -516, -511, -499, -468, -467, -445, -416, -402, -388, -377, -360, -357, -355, -351, -349, -300, -288, -278, -245, -209, -202, -156, -140, -124, -119, -95, -78, -73, -60, -2, 0, 12, 13, 108, 109, 117, 152, 158, 171, 181, 203, 225, 259, 261, 263, 266, 292, 349, 378, 387, 391, 392, 474, 490, 525, 543, 544, 563, 573, 633, 675, 678, 683, 689, 700, 701, 706, 738, 742, 754, 767, 804, 829, 846, 885, 893, 898, 946, 951, 971, 988, 1001, 1004, 1032, 1066, 1069, 1099, 1101, 1125, 1136, 1190, 1221, 1245, 1280, 1382, 1389, 1399, 1402, 1412, 1456, 1457, 1465, 1466, 1515, 1530, 1546, 1593, 1595, 1613, 1614, 1619, 1664, 1758, 1780, 1816, 1823, 1825, 1837, 1861, 1903, 1954, 1964, 1969, 1974, 1976, 1977, 2019, 2072, 2099, 2127, 2139, 2144, 2145, 2153, 2231, 2252, 2262, 2280, 2312, 2314, 2351, 2372, 2385, 2421, 2468, 2476, 2524, 2559, 2573, 2576, 2582, 2590, 2602, 2665, 2709, 2722, 2743, 2747, 2778, 2804, 2813, 2841, 2884, 2896, 2897, 2925, 2926, 2976, 3014, 3022, 3041, 3049, 3059, 3062, 3065, 3136, 3142, 3157, 3191, 3216, 3241, 3302, 3341, 3342, 3360, 3413, 3426, 3487, 3500, 3503, 3505, 3514, 3538, 3540, 3571, 3594, 3598, 3603, 3625, 3637, 3690, 3701, 3703, 3727, 3732, 3759, 3775, 3810, 3811, 3827, 3911, 3913, 3983, 3985, 3986, 4020, 4035, 4083, 4088, 4092, 4094, 4095},
			target:  -10000,
			output:  -1,
		},
	}

	for k, f := range binarysearch.SearchInRotatedSortedArray {
		t.Run(k, func(t *testing.T) {
			for _, c := range cases {
				o := f(c.numbers, c.target)

				if o != c.output {
					t.Errorf(
						"in %q with numbers %v and target %d, expected %d; got %d ",
						c.name,
						c.numbers,
						c.target,
						c.output,
						o,
					)
				}
			}
		})

	}
}
